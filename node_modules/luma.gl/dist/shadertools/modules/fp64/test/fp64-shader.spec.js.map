{"version":3,"sources":["../../../../../src/shadertools/modules/fp64/test/fp64-shader.spec.js"],"names":["BUFFER_DATA","Float32Array","glEnumToString","gl","value","NO_ERROR","p","toString","addSpan","contents","div","undefined","divs","body","getElementsByClassName","lastDiv","length","span","createElement","appendChild","innerHTML","addDiv","testInfoDiv","setAttribute","logToConsole","msg","console","log","escapeHTML","text","replace","testPassed","testFailed","glErrorShouldBe","glErrors","opt_msg","err","getError","ndx","indexOf","errStrs","ii","push","expected","join","fp64ify","a","a_hi","Math","fround","a_lo","getFloat64","upper","random","pow","getVec4Float64","getMat4Float64","result","i","initializeGL","canvas","viewport","width","height","clearColor","clearDepth","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","initializeTexTarget","framebuffer","createFramebuffer","bindFramebuffer","FRAMEBUFFER","tex","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","texImage2D","RGBA32F","RGBA","FLOAT","renderbuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","framebufferTexture2D","COLOR_ATTACHMENT0","framebufferRenderbuffer","DEPTH_ATTACHMENT","render","drawArrays","TRIANGLE_STRIP","getGPUOutput","buf","readPixels","checkError","reference","currentDiv","line","referece64","result64","abs","test_float_add","testName","float0","float1","float_ref","float0_vec2","float1_vec2","float_ref_vec2","program","vs","require","fs","modules","use","setBuffers","positions","target","ARRAY_BUFFER","data","size","setUniforms","b","ONE","test_float_sub","test_float_mul","test_float_div","test_float_sqrt","sqrt","test_float_exp","exp","test_float_log","test_float_sin","sin","test_float_cos","cos","test_float_tan","tan","test_float_radians","PI","onload","idx0","test_no","loop","cpu_result","gpu_result"],"mappings":"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","file":"fp64-shader.spec.js","sourcesContent":["// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n// TODO - need to clean up this code to follow lint rules, disable for now\n/* eslint-disable */\n\nimport 'babel-polyfill';\n\nimport {document, window} from 'global';\nimport {Buffer, createGLContext, Program, setParameters, assembleShaders, registerShaderModules, fp64} from 'luma.gl';\n\nconst BUFFER_DATA = new Float32Array([1, 1, -1, 1, 1, -1, -1, -1]);\n\n// Utilities functions that to be moved to a common place for future tests\n\nfunction glEnumToString(gl, value) {\n  // Optimization for the most common enum:\n  if (value === gl.NO_ERROR) {\n    return \"NO_ERROR\";\n  }\n  for (var p in gl) {\n    if (gl[p] == value) {\n      return p;\n    }\n  }\n  return \"0x\" + value.toString(16);\n};\n\nfunction addSpan(contents, div) {\n  if (div == undefined) {\n    var divs = document.body.getElementsByClassName(\"testInfo\");\n    var lastDiv = divs[divs.length - 1];\n    div = lastDiv;\n  }\n\n  var span = document.createElement(\"span\");\n  div.appendChild(span);\n  span.innerHTML = contents + '<br />';\n}\n\nfunction addDiv(contents) {\n  var testInfoDiv = document.createElement(\"div\");\n  document.body.appendChild(testInfoDiv);\n  testInfoDiv.setAttribute(\"class\", \"testInfo\");\n\n  return testInfoDiv;\n}\n\nfunction logToConsole(msg) {\n  if (window.console)\n    window.console.log(msg);\n}\n\nfunction escapeHTML(text) {\n  return text.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\");\n}\n\nfunction testPassed(msg) {\n  addSpan('<span><span class=\"pass\" style=\"color:green\">PASS</span> ' + escapeHTML(msg) + '</span>');\n  logToConsole('PASS ' + msg);\n}\n\nfunction testFailed(msg) {\n  addSpan('<span><span class=\"fail\" style=\"color:red\">FAIL</span> ' + escapeHTML(msg) + '</span>');\n  logToConsole('FAIL ' + msg);\n}\n\nfunction glErrorShouldBe(gl, glErrors, opt_msg) {\n  if (!glErrors.length) {\n    glErrors = [glErrors];\n  }\n  opt_msg = opt_msg || \"\";\n  var err = gl.getError();\n  var ndx = glErrors.indexOf(err);\n  var errStrs = [];\n  for (var ii = 0; ii < glErrors.length; ++ii) {\n    errStrs.push(glEnumToString(gl, glErrors[ii]));\n  }\n  var expected = errStrs.join(\" or \");\n  if (ndx < 0) {\n    var msg = \"getError expected\" + ((glErrors.length > 1) ? \" one of: \" : \": \");\n    testFailed(msg + expected +  \". Was \" + glEnumToString(gl, err) + \" : \" + opt_msg);\n  } else {\n    //var msg = \"getError was \" + ((glErrors.length > 1) ? \"one of: \" : \"expected value: \");\n    //testPassed(msg + expected + \" : \" + opt_msg);\n  }\n};\n\n// Special utility functions for df64 tests\n\nfunction fp64ify(a) {\n  const a_hi = Math.fround(a);\n  const a_lo = a - Math.fround(a);\n  return new Float32Array([a_hi, a_lo]);\n}\n\nfunction getFloat64(upper = 256) {\n  return Math.random() * Math.pow(2.0, (Math.random() - 0.5) * upper);\n}\n\nfunction getVec4Float64() {\n  return [getFloat64(), getFloat64(), getFloat64(), getFloat64()]\n}\n\nfunction getMat4Float64() {\n  var result = [];\n  for (var i = 0; i < 16; i++)\n  {\n    result.push(getFloat64());\n  }\n  return result;\n}\n\nfunction initializeGL(canvas)\n{\n  const gl = createGLContext(canvas);\n  setParameters(gl, {\n    viewport: [0, 0, canvas.width, canvas.height],\n    clearColor: [0, 0, 0, 1],\n    clearDepth: 1\n  });\n  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n  // var fp_texture_support = gl.getExtension('OES_texture_float');\n  // if (!fp_texture_support)\n  // {\n  //   console.error(\"no floating point texture support!\");\n  // }\n  return gl;\n}\n\nfunction initializeTexTarget(gl)\n{\n  var framebuffer = gl.createFramebuffer();\n  gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n  framebuffer.width = 10;\n  framebuffer.height = 10;\n\n  var tex = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, tex);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA32F, framebuffer.width, framebuffer.height, 0, gl.RGBA, gl.FLOAT, null);\n\n  var renderbuffer = gl.createRenderbuffer();\n  gl.bindRenderbuffer(gl.RENDERBUFFER, renderbuffer);\n  gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, framebuffer.width, framebuffer.height);\n  gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, tex, 0);\n  gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, renderbuffer);\n\n}\n\nfunction render(gl)\n{\n  gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n  glErrorShouldBe(gl, gl.NO_ERROR, \"no error from draw\");\n}\n\nfunction getGPUOutput(gl)\n{\n\n  var width = gl.canvas.width;\n  var height = gl.canvas.height;\n  var buf = new Float32Array(width * height * 4);\n\n  gl.readPixels(0, 0, width, height, gl.RGBA, gl.FLOAT, buf);\n\n  return buf;\n}\n\nfunction checkError(result, reference)\n{\n  var currentDiv = addDiv();\n  var line;\n  addSpan(\"------------------------\", currentDiv);\n\n  let referece64 = reference[0] + reference[1];\n  let result64 = result[0] + result[1];\n\n  line = 'CPU output: (' + reference[0].toString() + ',' + reference[1].toString() + ') = ' + referece64.toString() + '<br>';\n  addSpan(line, currentDiv);\n  line = \"GPU output: (\" + result[0].toString() + ',' + result[1].toString() + ',' + result[2].toString() + ',' + result[3].toString() + ') = ' + result64.toString() + '<br>';\n  addSpan(line, currentDiv);\n\n  line = \"error: \" + Math.abs((referece64 - result64) / referece64) + '<br>';\n  addSpan(line, currentDiv);\n\n\n  // var referenceBits = new Int32Array(reference.buffer);\n  // var resultBits = new Int32Array(result.buffer);\n\n  // var refHiExp = (referenceBits[0] & 0x7F800000) >>> 23;\n  // var refLoExp = (referenceBits[1] & 0x7F800000) >>> 23;\n  // var resHiExp = (resultBits[0] & 0x7F800000) >>> 23;\n  // var resLoExp = (resultBits[1] & 0x7F800000) >>> 23;\n\n  // var refHiMan = referenceBits[0] & 0x007FFFFF;\n  // var refLoMan = referenceBits[1] & 0x007FFFFF;\n  // var resHiMan = resultBits[0] & 0x007FFFFF;\n  // var resLoMan = resultBits[1] & 0x007FFFFF;\n\n  // if (refHiExp !== resHiExp || refLoExp !== resLoExp)\n  // {\n  //   line = \"High 8-bit exponent error: \" + Math.abs(refHiExp - resHiExp).toString() + \" ulp<br>\";\n  //   addSpan(line, currentDiv);\n  //   line = \"Low 8-bit exponent error: \" + Math.abs(refLoExp - resLoExp).toString() + \" ulp<br>\";\n  //   addSpan(line, currentDiv);\n  // }\n\n  // line = \"High 24-bit mantissa reference: \" + refHiMan.toString(2) + \" result: \" + resHiMan.toString(2) + \" error: \" + Math.abs(refHiMan - resHiMan).toString() + \" ulp<br>\";\n  // addSpan(line, currentDiv);\n  // line = \"Low 24-bit mantissa reference: \" + refLoMan.toString(2) + \" result: \" + resLoMan.toString(2) + \" error: \" + Math.abs(refLoMan - resLoMan).toString() + \" ulp<br>\";\n  // addSpan(line, currentDiv);\n}\n\n// Actual tests for different arithmetic functions\n\nfunction test_float_add(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // float +\n  const float0 = getFloat64();\n  const float1 = getFloat64();\n  const float_ref = float0 + float1;\n\n  const float0_vec2 = fp64ify(float0);\n  const float1_vec2 = fp64ify(float1);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_add.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }\n    ));\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    b: float1_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"(\" + float0_vec2.toString() + ') + (' + float1_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_sub(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // float -\n  const float0 = getFloat64();\n  const float1 = getFloat64();\n  const float_ref = float0 - float1;\n\n  const float0_vec2 = fp64ify(float0);\n  const float1_vec2 = fp64ify(float1);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n      vs: require('./vs_float_sub.glsl'),\n      fs: require('./fs.glsl'),\n      modules: ['fp64']\n    }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    b: float1_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"(\" + float0_vec2.toString() + ') - (' + float1_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_mul(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // float x\n  const float0 = getFloat64(128);\n  const float1 = getFloat64(128);\n\n  const float_ref = float0 * float1;\n\n  const float0_vec2 = fp64ify(float0);\n  const float1_vec2 = fp64ify(float1);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n    vs: require('./vs_float_mul.glsl'),\n    fs: require('./fs.glsl'),\n    modules: ['fp64']\n  }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    b: float1_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"(\" + float0_vec2.toString() + ') * (' + float1_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_div(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // float /\n  const float0 = getFloat64(128);\n  const float1 = getFloat64(128);\n  const float_ref = float0 / float1;\n\n  const float0_vec2 = fp64ify(float0);\n  const float1_vec2 = fp64ify(float1);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n    vs: require('./vs_float_div.glsl'),\n    fs: require('./fs.glsl'),\n    modules: ['fp64']\n  }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    b: float1_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"(\" + float0_vec2.toString() + ') / (' + float1_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_sqrt(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // sqrt\n  const float0 = getFloat64(128);\n  const float_ref = Math.sqrt(float0);\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_sqrt.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"sqrt(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_exp(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // exp\n  const float0 = getFloat64(6);\n  const float_ref = Math.exp(float0);\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_exp.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"exp(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_log(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // log\n  const float0 = getFloat64(24);\n  const float_ref = Math.log(float0);\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_log.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"log(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\n\nfunction test_float_sin(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // sin\n  const float0 = getFloat64(8);\n  const float_ref = Math.sin(float0);\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_sin.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"sin(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_cos(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // cos\n  const float0 = getFloat64(8);\n  const float_ref = Math.cos(float0);\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_cos.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"cos(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_tan(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // tan\n  const float0 = getFloat64(8);\n  const float_ref = Math.tan(float0);\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_tan.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"tan(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_radians(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // radians\n  const float0 = getFloat64(16);\n  const float_ref = float0 * Math.PI / 180.0;\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_radians.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"tan(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\n// Main entrance\nwindow.onload = () => {\n  const canvas = document.createElement('canvas');\n  document.body.appendChild(canvas);\n\n  canvas.width = 16;\n  canvas.height = 16;\n\n  // Initialize GL\n\n  var gl = initializeGL(canvas);\n  initializeTexTarget(gl);\n\n\n  registerShaderModules([fp64]);\n\n  var idx0;\n  var test_no = 0;\n  const loop = 100;\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_add(gl, \"Float addition test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_sub(gl, \"Float subtraction test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_mul(gl, \"Float multiplication test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_div(gl, \"Float division test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_sqrt(gl, \"Float sqrt test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_exp(gl, \"Float exp test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_log(gl, \"Float log test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_sin(gl, \"Float sin test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n   }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_cos(gl, \"Float cos test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n\n\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n\n    var cpu_result = test_float_tan(gl, \"Float tan test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n\n    var cpu_result = test_float_radians(gl, \"Float radians test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n}\n"]}