{"version":3,"sources":["../../src/deprecated/fx.js"],"names":["Queue","Fx","options","opt","delay","duration","transition","x","onCompute","onComplete","time","Date","now","animating","push","currentTime","delta","call","from","to","Transition","linear","p","Trans","prototype","makeTrans","params","Object","assign","easeIn","pos","easeOut","easeInOut","transitions","Pow","Math","pow","Expo","Circ","sin","acos","Sine","PI","Back","Bounce","value","a","b","Elastic","cos","t","forEach","elem","i","global","window","e","checkFxQueue","oldQueue","length","l","fx","step","found","impl","animationTime","requestAnimationFrame","callback","setTimeout"],"mappings":"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","file":"fx.js","sourcesContent":["// Timer based animation\n// TODO clean up linting\n/* eslint-disable */\n/* global setTimeout */\nimport {merge, noop, splat} from '../utils';\n\nvar Queue = [];\n\nexport default class Fx {\n  constructor(options = {}) {\n    this.opt = merge({\n      delay: 0,\n      duration: 1000,\n      transition: x => x,\n      onCompute: noop,\n      onComplete: noop\n    }, options);\n  }\n\n  start(options) {\n    this.opt = merge(this.opt, options || {});\n    this.time = Date.now();\n    this.animating = true;\n    Queue.push(this);\n  }\n\n  // perform a step in the animation\n  step() {\n    // if not animating, then return\n    if (!this.animating) {\n      return;\n    }\n    var currentTime = Date.now(),\n      time = this.time,\n      opt = this.opt,\n      delay = opt.delay,\n      duration = opt.duration,\n      delta = 0;\n    // hold animation for the delay\n    if (currentTime < time + delay) {\n      opt.onCompute.call(this, delta);\n      return;\n    }\n    // if in our time window, then execute animation\n    if (currentTime < time + delay + duration) {\n      delta = opt.transition((currentTime - time - delay) / duration);\n      opt.onCompute.call(this, delta);\n    } else {\n      this.animating = false;\n      opt.onCompute.call(this, 1);\n      opt.onComplete.call(this);\n    }\n  }\n\n  static compute(from, to, delta) {\n    return from + (to - from) * delta;\n  }\n}\n\nFx.Queue = Queue;\n\n// Easing equations\nFx.Transition = {\n  linear(p) {\n    return p;\n  }\n};\n\nvar Trans = Fx.Transition;\n\nFx.prototype.time = null;\n\nfunction makeTrans(transition, params) {\n  params = splat(params);\n  return Object.assign(transition, {\n    easeIn(pos) {\n      return transition(pos, params);\n    },\n    easeOut(pos) {\n      return 1 - transition(1 - pos, params);\n    },\n    easeInOut(pos) {\n      return (pos <= 0.5) ? transition(2 * pos, params) / 2 :\n        (2 - transition(2 * (1 - pos), params)) / 2;\n    }\n  });\n}\n\nvar transitions = {\n\n  Pow(p, x) {\n    return Math.pow(p, x[0] || 6);\n  },\n\n  Expo(p) {\n    return Math.pow(2, 8 * (p - 1));\n  },\n\n  Circ(p) {\n    return 1 - Math.sin(Math.acos(p));\n  },\n\n  Sine(p) {\n    return 1 - Math.sin((1 - p) * Math.PI / 2);\n  },\n\n  Back(p, x) {\n    x = x[0] || 1.618;\n    return Math.pow(p, 2) * ((x + 1) * p - x);\n  },\n\n  Bounce(p) {\n    var value;\n    for (let a = 0, b = 1; 1; a += b, b /= 2) {\n      if (p >= (7 - 4 * a) / 11) {\n        value = b * b - Math.pow((11 - 6 * a - 11 * p) / 4, 2);\n        break;\n      }\n    }\n    return value;\n  },\n\n  Elastic(p, x) {\n    return Math.pow(2, 10 * --p) * Math.cos(20 * p * Math.PI * (x[0] || 1) / 3);\n  }\n\n};\n\nfor (const t in transitions) {\n  Trans[t] = makeTrans(transitions[t]);\n}\n\n['Quad', 'Cubic', 'Quart', 'Quint'].forEach(function(elem, i) {\n  Trans[elem] = makeTrans(function(p) {\n    return Math.pow(p, [\n      i + 2\n    ]);\n  });\n});\n\n// animationTime - function branching\n\n// rye: TODO- refactor global definition when we define the two\n//           (browserify/<script>) build paths.\nvar global;\ntry {\n  global = window;\n} catch (e) {\n  global = null;\n}\n\nvar checkFxQueue = function() {\n  var oldQueue = Queue;\n  Queue = [];\n  if (oldQueue.length) {\n    for (var i = 0, l = oldQueue.length, fx; i < l; i++) {\n      fx = oldQueue[i];\n      fx.step();\n      if (fx.animating) {\n        Queue.push(fx);\n      }\n    }\n    Fx.Queue = Queue;\n  }\n};\n\nif (global) {\n  var found = false;\n  ['webkitAnimationTime', 'mozAnimationTime', 'animationTime',\n   'webkitAnimationStartTime', 'mozAnimationStartTime', 'animationStartTime']\n    .forEach(impl => {\n      if (impl in global) {\n        Fx.animationTime = function() {\n          return global[impl];\n        };\n        found = true;\n      }\n    });\n  if (!found) {\n    Fx.animationTime = Date.now;\n  }\n  // requestAnimationFrame - function branching\n  found = false;\n  ['webkitRequestAnimationFrame', 'mozRequestAnimationFrame',\n   'requestAnimationFrame']\n    .forEach(function(impl) {\n      if (impl in global) {\n        Fx.requestAnimationFrame = function(callback) {\n          global[impl](function() {\n            checkFxQueue();\n            callback();\n          });\n        };\n        found = true;\n      }\n    });\n  if (!found) {\n    Fx.requestAnimationFrame = function(callback) {\n      setTimeout(function() {\n        checkFxQueue();\n        callback();\n      }, 1000 / 60);\n    };\n  }\n}\n"]}